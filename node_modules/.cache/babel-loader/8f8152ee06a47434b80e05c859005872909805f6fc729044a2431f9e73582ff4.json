{"ast":null,"code":"export class SchedulingAlgorithm {\n  constructor(courses, teachers, timeSlots) {\n    this.courses = void 0;\n    this.teachers = void 0;\n    this.timeSlots = void 0;\n    this.schedule = void 0;\n    this.courses = courses;\n    this.teachers = teachers;\n    this.timeSlots = timeSlots.sort((a, b) => a.order - b.order);\n    this.schedule = [];\n  }\n\n  // 主排课方法\n  generateSchedule() {\n    this.schedule = [];\n    const conflicts = [];\n    try {\n      // 根据每个课程的固定时间段生成课表\n      for (const course of this.courses) {\n        this.scheduleForCourse(course);\n      }\n\n      // 检查冲突\n      const detectedConflicts = this.detectConflicts();\n      conflicts.push(...detectedConflicts);\n      return {\n        schedule: this.schedule,\n        conflicts,\n        success: conflicts.length === 0,\n        message: conflicts.length === 0 ? '课表生成成功！' : `课表生成完成，但存在 ${conflicts.length} 个时间冲突`\n      };\n    } catch (error) {\n      return {\n        schedule: [],\n        conflicts,\n        success: false,\n        message: `生成失败: ${error instanceof Error ? error.message : '未知错误'}`\n      };\n    }\n  }\n\n  // 为单个课程排课\n  scheduleForCourse(course) {\n    // 根据课程的固定时间段生成课表条目\n    for (const fixedSlot of course.fixedTimeSlots) {\n      for (const timeSlotId of fixedSlot.timeSlotIds) {\n        const scheduleItem = {\n          id: `${course.id}-${fixedSlot.dayOfWeek}-${timeSlotId}`,\n          courseId: course.id,\n          teacherId: course.teacherId,\n          timeSlotId: timeSlotId,\n          dayOfWeek: fixedSlot.dayOfWeek,\n          location: course.location\n        };\n        this.schedule.push(scheduleItem);\n      }\n    }\n  }\n\n  // 寻找最佳时间段\n  findBestSlot(course, classItem, sessionIndex) {\n    const teacher = this.teachers.find(t => t.id === course.teacherId);\n    if (!teacher) return null;\n\n    // 获取可用的时间段\n    const availableSlots = this.getAvailableTimeSlots(course, classItem, teacher);\n    if (availableSlots.length === 0) return null;\n\n    // 评分并选择最佳时间段\n    const scoredSlots = availableSlots.map(slot => ({\n      ...slot,\n      score: this.calculateSlotScore(slot, course, classItem, teacher)\n    }));\n    scoredSlots.sort((a, b) => b.score - a.score);\n    const bestSlot = scoredSlots[0];\n\n    // 分配教室\n    const classroom = this.assignClassroom(course, bestSlot.dayOfWeek, bestSlot.timeSlotId);\n    if (!classroom) return null;\n    return {\n      id: `${course.id}-${classItem.id}-${sessionIndex}`,\n      courseId: course.id,\n      classId: classItem.id,\n      teacherId: course.teacherId,\n      classroomId: classroom.id,\n      timeSlotId: bestSlot.timeSlotId,\n      dayOfWeek: bestSlot.dayOfWeek\n    };\n  }\n\n  // 获取可用时间段\n  getAvailableTimeSlots(course, classItem, teacher) {\n    const availableSlots = [];\n    for (let day = 1; day <= 5; day++) {\n      // 周一到周五\n      for (const timeSlot of this.timeSlots) {\n        // 检查教师是否可用\n        if (teacher.unavailableSlots.includes(timeSlot.id)) continue;\n\n        // 检查是否在禁止时间段\n        if (this.constraints.forbiddenSlots.some(fs => fs.dayOfWeek === day && fs.timeSlotId === timeSlot.id)) continue;\n\n        // 检查教师冲突\n        if (this.hasTeacherConflict(teacher.id, day, timeSlot.id)) continue;\n\n        // 检查班级冲突\n        if (this.hasClassConflict(classItem.id, day, timeSlot.id)) continue;\n\n        // 检查连续课程要求\n        if (course.duration > 1 && course.requirements.consecutiveSlots) {\n          if (this.canScheduleConsecutiveSlots(course, day, timeSlot.id, classItem.id, teacher.id)) {\n            availableSlots.push({\n              dayOfWeek: day,\n              timeSlotId: timeSlot.id\n            });\n          }\n        } else {\n          availableSlots.push({\n            dayOfWeek: day,\n            timeSlotId: timeSlot.id\n          });\n        }\n      }\n    }\n    return availableSlots;\n  }\n\n  // 计算时间段评分\n  calculateSlotScore(slot, course, classItem, teacher) {\n    let score = 100;\n\n    // 避免午休时间\n    if (this.constraints.lunchBreakSlots.includes(slot.timeSlotId)) {\n      score -= 20;\n    }\n\n    // 优先上午时间\n    const timeSlot = this.timeSlots.find(ts => ts.id === slot.timeSlotId);\n    if (timeSlot && timeSlot.order <= 4) {\n      score += 10;\n    }\n\n    // 避免周五下午\n    if (slot.dayOfWeek === 5 && timeSlot && timeSlot.order > 4) {\n      score -= 15;\n    }\n\n    // 检查班级当天已有课程数量\n    const dailyClasses = this.schedule.filter(s => s.classId === classItem.id && s.dayOfWeek === slot.dayOfWeek).length;\n    if (dailyClasses >= this.constraints.maxDailyHours) {\n      score -= 50;\n    }\n    return score;\n  }\n\n  // 分配教室\n  assignClassroom(course, dayOfWeek, timeSlotId) {\n    // 如果课程指定了教室\n    if (course.classroomId) {\n      const classroom = this.classrooms.find(c => c.id === course.classroomId);\n      if (classroom && !this.hasClassroomConflict(classroom.id, dayOfWeek, timeSlotId)) {\n        return classroom;\n      }\n    }\n\n    // 根据要求筛选教室\n    let availableClassrooms = this.classrooms.filter(classroom => {\n      // 检查容量\n      if (classroom.capacity < course.studentCount) return false;\n\n      // 检查类型要求\n      if (course.requirements.classroomType && classroom.type !== course.requirements.classroomType) return false;\n\n      // 检查设备要求\n      if (course.requirements.equipment) {\n        const hasAllEquipment = course.requirements.equipment.every(equipment => classroom.equipment.includes(equipment));\n        if (!hasAllEquipment) return false;\n      }\n\n      // 检查时间冲突\n      if (this.hasClassroomConflict(classroom.id, dayOfWeek, timeSlotId)) return false;\n      return true;\n    });\n\n    // 按容量排序，优先选择容量适中的教室\n    availableClassrooms.sort((a, b) => {\n      const aWaste = a.capacity - course.studentCount;\n      const bWaste = b.capacity - course.studentCount;\n      return aWaste - bWaste;\n    });\n    return availableClassrooms[0] || null;\n  }\n\n  // 检查教师冲突\n  hasTeacherConflict(teacherId, dayOfWeek, timeSlotId) {\n    return this.schedule.some(item => item.teacherId === teacherId && item.dayOfWeek === dayOfWeek && item.timeSlotId === timeSlotId);\n  }\n\n  // 检查班级冲突\n  hasClassConflict(classId, dayOfWeek, timeSlotId) {\n    return this.schedule.some(item => item.classId === classId && item.dayOfWeek === dayOfWeek && item.timeSlotId === timeSlotId);\n  }\n\n  // 检查教室冲突\n  hasClassroomConflict(classroomId, dayOfWeek, timeSlotId) {\n    return this.schedule.some(item => item.classroomId === classroomId && item.dayOfWeek === dayOfWeek && item.timeSlotId === timeSlotId);\n  }\n\n  // 检查是否可以安排连续时间段\n  canScheduleConsecutiveSlots(course, dayOfWeek, startTimeSlotId, classId, teacherId) {\n    const startSlot = this.timeSlots.find(ts => ts.id === startTimeSlotId);\n    if (!startSlot) return false;\n    const startIndex = this.timeSlots.indexOf(startSlot);\n\n    // 检查是否有足够的连续时间段\n    for (let i = 0; i < course.duration; i++) {\n      const slotIndex = startIndex + i;\n      if (slotIndex >= this.timeSlots.length) return false;\n      const timeSlot = this.timeSlots[slotIndex];\n\n      // 检查教师和班级冲突\n      if (this.hasTeacherConflict(teacherId, dayOfWeek, timeSlot.id) || this.hasClassConflict(classId, dayOfWeek, timeSlot.id)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  // 检测冲突\n  detectConflicts() {\n    const conflicts = [];\n\n    // 检查教师冲突\n    const teacherConflicts = this.detectTeacherConflicts();\n    conflicts.push(...teacherConflicts);\n\n    // 检查教室冲突\n    const classroomConflicts = this.detectClassroomConflicts();\n    conflicts.push(...classroomConflicts);\n\n    // 检查班级冲突\n    const classConflicts = this.detectClassConflicts();\n    conflicts.push(...classConflicts);\n    return conflicts;\n  }\n  detectTeacherConflicts() {\n    const conflicts = [];\n    const teacherSchedule = new Map();\n\n    // 按教师分组\n    this.schedule.forEach(item => {\n      if (!teacherSchedule.has(item.teacherId)) {\n        teacherSchedule.set(item.teacherId, []);\n      }\n      teacherSchedule.get(item.teacherId).push(item);\n    });\n\n    // 检查每个教师的时间冲突\n    teacherSchedule.forEach((items, teacherId) => {\n      const timeMap = new Map();\n      items.forEach(item => {\n        const key = `${item.dayOfWeek}-${item.timeSlotId}`;\n        if (!timeMap.has(key)) {\n          timeMap.set(key, []);\n        }\n        timeMap.get(key).push(item);\n      });\n      timeMap.forEach(conflictItems => {\n        if (conflictItems.length > 1) {\n          const teacher = this.teachers.find(t => t.id === teacherId);\n          conflicts.push({\n            type: 'teacher',\n            message: `教师 ${(teacher === null || teacher === void 0 ? void 0 : teacher.name) || teacherId} 在同一时间段有多个课程安排`,\n            items: conflictItems\n          });\n        }\n      });\n    });\n    return conflicts;\n  }\n  detectClassroomConflicts() {\n    const conflicts = [];\n    const classroomSchedule = new Map();\n\n    // 按教室分组\n    this.schedule.forEach(item => {\n      if (!classroomSchedule.has(item.classroomId)) {\n        classroomSchedule.set(item.classroomId, []);\n      }\n      classroomSchedule.get(item.classroomId).push(item);\n    });\n\n    // 检查每个教室的时间冲突\n    classroomSchedule.forEach((items, classroomId) => {\n      const timeMap = new Map();\n      items.forEach(item => {\n        const key = `${item.dayOfWeek}-${item.timeSlotId}`;\n        if (!timeMap.has(key)) {\n          timeMap.set(key, []);\n        }\n        timeMap.get(key).push(item);\n      });\n      timeMap.forEach(conflictItems => {\n        if (conflictItems.length > 1) {\n          const classroom = this.classrooms.find(c => c.id === classroomId);\n          conflicts.push({\n            type: 'classroom',\n            message: `教室 ${(classroom === null || classroom === void 0 ? void 0 : classroom.name) || classroomId} 在同一时间段被多个课程占用`,\n            items: conflictItems\n          });\n        }\n      });\n    });\n    return conflicts;\n  }\n  detectClassConflicts() {\n    const conflicts = [];\n    const classSchedule = new Map();\n\n    // 按班级分组\n    this.schedule.forEach(item => {\n      if (!classSchedule.has(item.classId)) {\n        classSchedule.set(item.classId, []);\n      }\n      classSchedule.get(item.classId).push(item);\n    });\n\n    // 检查每个班级的时间冲突\n    classSchedule.forEach((items, classId) => {\n      const timeMap = new Map();\n      items.forEach(item => {\n        const key = `${item.dayOfWeek}-${item.timeSlotId}`;\n        if (!timeMap.has(key)) {\n          timeMap.set(key, []);\n        }\n        timeMap.get(key).push(item);\n      });\n      timeMap.forEach(conflictItems => {\n        if (conflictItems.length > 1) {\n          const classItem = this.classes.find(c => c.id === classId);\n          conflicts.push({\n            type: 'class',\n            message: `班级 ${(classItem === null || classItem === void 0 ? void 0 : classItem.name) || classId} 在同一时间段有多个课程安排`,\n            items: conflictItems\n          });\n        }\n      });\n    });\n    return conflicts;\n  }\n}","map":{"version":3,"names":["SchedulingAlgorithm","constructor","courses","teachers","timeSlots","schedule","sort","a","b","order","generateSchedule","conflicts","course","scheduleForCourse","detectedConflicts","detectConflicts","push","success","length","message","error","Error","fixedSlot","fixedTimeSlots","timeSlotId","timeSlotIds","scheduleItem","id","dayOfWeek","courseId","teacherId","location","findBestSlot","classItem","sessionIndex","teacher","find","t","availableSlots","getAvailableTimeSlots","scoredSlots","map","slot","score","calculateSlotScore","bestSlot","classroom","assignClassroom","classId","classroomId","day","timeSlot","unavailableSlots","includes","constraints","forbiddenSlots","some","fs","hasTeacherConflict","hasClassConflict","duration","requirements","consecutiveSlots","canScheduleConsecutiveSlots","lunchBreakSlots","ts","dailyClasses","filter","s","maxDailyHours","classrooms","c","hasClassroomConflict","availableClassrooms","capacity","studentCount","classroomType","type","equipment","hasAllEquipment","every","aWaste","bWaste","item","startTimeSlotId","startSlot","startIndex","indexOf","i","slotIndex","teacherConflicts","detectTeacherConflicts","classroomConflicts","detectClassroomConflicts","classConflicts","detectClassConflicts","teacherSchedule","Map","forEach","has","set","get","items","timeMap","key","conflictItems","name","classroomSchedule","classSchedule","classes"],"sources":["D:/code/classtable/src/utils/schedulingAlgorithm.ts"],"sourcesContent":["import { \r\n  Course, \r\n  Teacher, \r\n  TimeSlot, \r\n  ScheduleItem, \r\n  Conflict \r\n} from '../types';\r\n\r\nexport interface SchedulingResult {\r\n  schedule: ScheduleItem[];\r\n  conflicts: Conflict[];\r\n  success: boolean;\r\n  message: string;\r\n}\r\n\r\nexport class SchedulingAlgorithm {\r\n  private courses: Course[];\r\n  private teachers: Teacher[];\r\n  private timeSlots: TimeSlot[];\r\n  private schedule: ScheduleItem[];\r\n\r\n  constructor(\r\n    courses: Course[],\r\n    teachers: Teacher[],\r\n    timeSlots: TimeSlot[]\r\n  ) {\r\n    this.courses = courses;\r\n    this.teachers = teachers;\r\n    this.timeSlots = timeSlots.sort((a, b) => a.order - b.order);\r\n    this.schedule = [];\r\n  }\r\n\r\n  // 主排课方法\r\n  public generateSchedule(): SchedulingResult {\r\n    this.schedule = [];\r\n    const conflicts: Conflict[] = [];\r\n\r\n    try {\r\n      // 根据每个课程的固定时间段生成课表\r\n      for (const course of this.courses) {\r\n        this.scheduleForCourse(course);\r\n      }\r\n\r\n      // 检查冲突\r\n      const detectedConflicts = this.detectConflicts();\r\n      conflicts.push(...detectedConflicts);\r\n\r\n      return {\r\n        schedule: this.schedule,\r\n        conflicts,\r\n        success: conflicts.length === 0,\r\n        message: conflicts.length === 0 \r\n          ? '课表生成成功！' \r\n          : `课表生成完成，但存在 ${conflicts.length} 个时间冲突`\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        schedule: [],\r\n        conflicts,\r\n        success: false,\r\n        message: `生成失败: ${error instanceof Error ? error.message : '未知错误'}`\r\n      };\r\n    }\r\n  }\r\n\r\n  // 为单个课程排课\r\n  private scheduleForCourse(course: Course): void {\r\n    // 根据课程的固定时间段生成课表条目\r\n    for (const fixedSlot of course.fixedTimeSlots) {\r\n      for (const timeSlotId of fixedSlot.timeSlotIds) {\r\n        const scheduleItem: ScheduleItem = {\r\n          id: `${course.id}-${fixedSlot.dayOfWeek}-${timeSlotId}`,\r\n          courseId: course.id,\r\n          teacherId: course.teacherId,\r\n          timeSlotId: timeSlotId,\r\n          dayOfWeek: fixedSlot.dayOfWeek,\r\n          location: course.location\r\n        };\r\n        \r\n        this.schedule.push(scheduleItem);\r\n      }\r\n    }\r\n  }\r\n\r\n  // 寻找最佳时间段\r\n  private findBestSlot(course: Course, classItem: Class, sessionIndex: number): ScheduleItem | null {\r\n    const teacher = this.teachers.find(t => t.id === course.teacherId);\r\n    if (!teacher) return null;\r\n\r\n    // 获取可用的时间段\r\n    const availableSlots = this.getAvailableTimeSlots(course, classItem, teacher);\r\n    \r\n    if (availableSlots.length === 0) return null;\r\n\r\n    // 评分并选择最佳时间段\r\n    const scoredSlots = availableSlots.map(slot => ({\r\n      ...slot,\r\n      score: this.calculateSlotScore(slot, course, classItem, teacher)\r\n    }));\r\n\r\n    scoredSlots.sort((a, b) => b.score - a.score);\r\n    const bestSlot = scoredSlots[0];\r\n\r\n    // 分配教室\r\n    const classroom = this.assignClassroom(course, bestSlot.dayOfWeek, bestSlot.timeSlotId);\r\n    if (!classroom) return null;\r\n\r\n    return {\r\n      id: `${course.id}-${classItem.id}-${sessionIndex}`,\r\n      courseId: course.id,\r\n      classId: classItem.id,\r\n      teacherId: course.teacherId,\r\n      classroomId: classroom.id,\r\n      timeSlotId: bestSlot.timeSlotId,\r\n      dayOfWeek: bestSlot.dayOfWeek\r\n    };\r\n  }\r\n\r\n  // 获取可用时间段\r\n  private getAvailableTimeSlots(course: Course, classItem: Class, teacher: Teacher) {\r\n    const availableSlots: { dayOfWeek: number; timeSlotId: string }[] = [];\r\n\r\n    for (let day = 1; day <= 5; day++) { // 周一到周五\r\n      for (const timeSlot of this.timeSlots) {\r\n        // 检查教师是否可用\r\n        if (teacher.unavailableSlots.includes(timeSlot.id)) continue;\r\n\r\n        // 检查是否在禁止时间段\r\n        if (this.constraints.forbiddenSlots.some(\r\n          fs => fs.dayOfWeek === day && fs.timeSlotId === timeSlot.id\r\n        )) continue;\r\n\r\n        // 检查教师冲突\r\n        if (this.hasTeacherConflict(teacher.id, day, timeSlot.id)) continue;\r\n\r\n        // 检查班级冲突\r\n        if (this.hasClassConflict(classItem.id, day, timeSlot.id)) continue;\r\n\r\n        // 检查连续课程要求\r\n        if (course.duration > 1 && course.requirements.consecutiveSlots) {\r\n          if (this.canScheduleConsecutiveSlots(course, day, timeSlot.id, classItem.id, teacher.id)) {\r\n            availableSlots.push({ dayOfWeek: day, timeSlotId: timeSlot.id });\r\n          }\r\n        } else {\r\n          availableSlots.push({ dayOfWeek: day, timeSlotId: timeSlot.id });\r\n        }\r\n      }\r\n    }\r\n\r\n    return availableSlots;\r\n  }\r\n\r\n  // 计算时间段评分\r\n  private calculateSlotScore(\r\n    slot: { dayOfWeek: number; timeSlotId: string },\r\n    course: Course,\r\n    classItem: Class,\r\n    teacher: Teacher\r\n  ): number {\r\n    let score = 100;\r\n\r\n    // 避免午休时间\r\n    if (this.constraints.lunchBreakSlots.includes(slot.timeSlotId)) {\r\n      score -= 20;\r\n    }\r\n\r\n    // 优先上午时间\r\n    const timeSlot = this.timeSlots.find(ts => ts.id === slot.timeSlotId);\r\n    if (timeSlot && timeSlot.order <= 4) {\r\n      score += 10;\r\n    }\r\n\r\n    // 避免周五下午\r\n    if (slot.dayOfWeek === 5 && timeSlot && timeSlot.order > 4) {\r\n      score -= 15;\r\n    }\r\n\r\n    // 检查班级当天已有课程数量\r\n    const dailyClasses = this.schedule.filter(\r\n      s => s.classId === classItem.id && s.dayOfWeek === slot.dayOfWeek\r\n    ).length;\r\n    \r\n    if (dailyClasses >= this.constraints.maxDailyHours) {\r\n      score -= 50;\r\n    }\r\n\r\n    return score;\r\n  }\r\n\r\n  // 分配教室\r\n  private assignClassroom(course: Course, dayOfWeek: number, timeSlotId: string): Classroom | null {\r\n    // 如果课程指定了教室\r\n    if (course.classroomId) {\r\n      const classroom = this.classrooms.find(c => c.id === course.classroomId);\r\n      if (classroom && !this.hasClassroomConflict(classroom.id, dayOfWeek, timeSlotId)) {\r\n        return classroom;\r\n      }\r\n    }\r\n\r\n    // 根据要求筛选教室\r\n    let availableClassrooms = this.classrooms.filter(classroom => {\r\n      // 检查容量\r\n      if (classroom.capacity < course.studentCount) return false;\r\n\r\n      // 检查类型要求\r\n      if (course.requirements.classroomType && \r\n          classroom.type !== course.requirements.classroomType) return false;\r\n\r\n      // 检查设备要求\r\n      if (course.requirements.equipment) {\r\n        const hasAllEquipment = course.requirements.equipment.every(\r\n          equipment => classroom.equipment.includes(equipment)\r\n        );\r\n        if (!hasAllEquipment) return false;\r\n      }\r\n\r\n      // 检查时间冲突\r\n      if (this.hasClassroomConflict(classroom.id, dayOfWeek, timeSlotId)) return false;\r\n\r\n      return true;\r\n    });\r\n\r\n    // 按容量排序，优先选择容量适中的教室\r\n    availableClassrooms.sort((a, b) => {\r\n      const aWaste = a.capacity - course.studentCount;\r\n      const bWaste = b.capacity - course.studentCount;\r\n      return aWaste - bWaste;\r\n    });\r\n\r\n    return availableClassrooms[0] || null;\r\n  }\r\n\r\n  // 检查教师冲突\r\n  private hasTeacherConflict(teacherId: string, dayOfWeek: number, timeSlotId: string): boolean {\r\n    return this.schedule.some(\r\n      item => item.teacherId === teacherId && \r\n               item.dayOfWeek === dayOfWeek && \r\n               item.timeSlotId === timeSlotId\r\n    );\r\n  }\r\n\r\n  // 检查班级冲突\r\n  private hasClassConflict(classId: string, dayOfWeek: number, timeSlotId: string): boolean {\r\n    return this.schedule.some(\r\n      item => item.classId === classId && \r\n               item.dayOfWeek === dayOfWeek && \r\n               item.timeSlotId === timeSlotId\r\n    );\r\n  }\r\n\r\n  // 检查教室冲突\r\n  private hasClassroomConflict(classroomId: string, dayOfWeek: number, timeSlotId: string): boolean {\r\n    return this.schedule.some(\r\n      item => item.classroomId === classroomId && \r\n               item.dayOfWeek === dayOfWeek && \r\n               item.timeSlotId === timeSlotId\r\n    );\r\n  }\r\n\r\n  // 检查是否可以安排连续时间段\r\n  private canScheduleConsecutiveSlots(\r\n    course: Course, \r\n    dayOfWeek: number, \r\n    startTimeSlotId: string,\r\n    classId: string,\r\n    teacherId: string\r\n  ): boolean {\r\n    const startSlot = this.timeSlots.find(ts => ts.id === startTimeSlotId);\r\n    if (!startSlot) return false;\r\n\r\n    const startIndex = this.timeSlots.indexOf(startSlot);\r\n    \r\n    // 检查是否有足够的连续时间段\r\n    for (let i = 0; i < course.duration; i++) {\r\n      const slotIndex = startIndex + i;\r\n      if (slotIndex >= this.timeSlots.length) return false;\r\n\r\n      const timeSlot = this.timeSlots[slotIndex];\r\n      \r\n      // 检查教师和班级冲突\r\n      if (this.hasTeacherConflict(teacherId, dayOfWeek, timeSlot.id) ||\r\n          this.hasClassConflict(classId, dayOfWeek, timeSlot.id)) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  // 检测冲突\r\n  private detectConflicts(): Conflict[] {\r\n    const conflicts: Conflict[] = [];\r\n\r\n    // 检查教师冲突\r\n    const teacherConflicts = this.detectTeacherConflicts();\r\n    conflicts.push(...teacherConflicts);\r\n\r\n    // 检查教室冲突\r\n    const classroomConflicts = this.detectClassroomConflicts();\r\n    conflicts.push(...classroomConflicts);\r\n\r\n    // 检查班级冲突\r\n    const classConflicts = this.detectClassConflicts();\r\n    conflicts.push(...classConflicts);\r\n\r\n    return conflicts;\r\n  }\r\n\r\n  private detectTeacherConflicts(): Conflict[] {\r\n    const conflicts: Conflict[] = [];\r\n    const teacherSchedule = new Map<string, ScheduleItem[]>();\r\n\r\n    // 按教师分组\r\n    this.schedule.forEach(item => {\r\n      if (!teacherSchedule.has(item.teacherId)) {\r\n        teacherSchedule.set(item.teacherId, []);\r\n      }\r\n      teacherSchedule.get(item.teacherId)!.push(item);\r\n    });\r\n\r\n    // 检查每个教师的时间冲突\r\n    teacherSchedule.forEach((items, teacherId) => {\r\n      const timeMap = new Map<string, ScheduleItem[]>();\r\n      \r\n      items.forEach(item => {\r\n        const key = `${item.dayOfWeek}-${item.timeSlotId}`;\r\n        if (!timeMap.has(key)) {\r\n          timeMap.set(key, []);\r\n        }\r\n        timeMap.get(key)!.push(item);\r\n      });\r\n\r\n      timeMap.forEach(conflictItems => {\r\n        if (conflictItems.length > 1) {\r\n          const teacher = this.teachers.find(t => t.id === teacherId);\r\n          conflicts.push({\r\n            type: 'teacher',\r\n            message: `教师 ${teacher?.name || teacherId} 在同一时间段有多个课程安排`,\r\n            items: conflictItems\r\n          });\r\n        }\r\n      });\r\n    });\r\n\r\n    return conflicts;\r\n  }\r\n\r\n  private detectClassroomConflicts(): Conflict[] {\r\n    const conflicts: Conflict[] = [];\r\n    const classroomSchedule = new Map<string, ScheduleItem[]>();\r\n\r\n    // 按教室分组\r\n    this.schedule.forEach(item => {\r\n      if (!classroomSchedule.has(item.classroomId)) {\r\n        classroomSchedule.set(item.classroomId, []);\r\n      }\r\n      classroomSchedule.get(item.classroomId)!.push(item);\r\n    });\r\n\r\n    // 检查每个教室的时间冲突\r\n    classroomSchedule.forEach((items, classroomId) => {\r\n      const timeMap = new Map<string, ScheduleItem[]>();\r\n      \r\n      items.forEach(item => {\r\n        const key = `${item.dayOfWeek}-${item.timeSlotId}`;\r\n        if (!timeMap.has(key)) {\r\n          timeMap.set(key, []);\r\n        }\r\n        timeMap.get(key)!.push(item);\r\n      });\r\n\r\n      timeMap.forEach(conflictItems => {\r\n        if (conflictItems.length > 1) {\r\n          const classroom = this.classrooms.find(c => c.id === classroomId);\r\n          conflicts.push({\r\n            type: 'classroom',\r\n            message: `教室 ${classroom?.name || classroomId} 在同一时间段被多个课程占用`,\r\n            items: conflictItems\r\n          });\r\n        }\r\n      });\r\n    });\r\n\r\n    return conflicts;\r\n  }\r\n\r\n  private detectClassConflicts(): Conflict[] {\r\n    const conflicts: Conflict[] = [];\r\n    const classSchedule = new Map<string, ScheduleItem[]>();\r\n\r\n    // 按班级分组\r\n    this.schedule.forEach(item => {\r\n      if (!classSchedule.has(item.classId)) {\r\n        classSchedule.set(item.classId, []);\r\n      }\r\n      classSchedule.get(item.classId)!.push(item);\r\n    });\r\n\r\n    // 检查每个班级的时间冲突\r\n    classSchedule.forEach((items, classId) => {\r\n      const timeMap = new Map<string, ScheduleItem[]>();\r\n      \r\n      items.forEach(item => {\r\n        const key = `${item.dayOfWeek}-${item.timeSlotId}`;\r\n        if (!timeMap.has(key)) {\r\n          timeMap.set(key, []);\r\n        }\r\n        timeMap.get(key)!.push(item);\r\n      });\r\n\r\n      timeMap.forEach(conflictItems => {\r\n        if (conflictItems.length > 1) {\r\n          const classItem = this.classes.find(c => c.id === classId);\r\n          conflicts.push({\r\n            type: 'class',\r\n            message: `班级 ${classItem?.name || classId} 在同一时间段有多个课程安排`,\r\n            items: conflictItems\r\n          });\r\n        }\r\n      });\r\n    });\r\n\r\n    return conflicts;\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
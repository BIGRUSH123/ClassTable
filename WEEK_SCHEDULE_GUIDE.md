# 按周课表功能使用指南

## 🎯 功能概述

本项目现已支持按周生成和管理课表，能够处理复杂的课程时间安排，包括：
- 支持20周的学期管理
- 复杂时间格式解析（如：1-6周，星期一第5-6节）
- 不同周次可能有不同的上课时间和地点
- 按周查看课表，支持周次切换

## 🚀 主要功能

### 1. 智能课程解析 ⭐ **重大更新**

在课程管理页面点击"智能解析导入"按钮，现已支持：

#### 📋 **预览和编辑功能**
- **可视化预览**：导入前预览所有解析结果
- **在线编辑**：在预览表格中直接修改课程信息
- **冲突检测**：实时检测课程时间冲突和重复
- **错误提示**：智能识别和提示数据问题
- **一键修复**：自动修复常见的数据重复问题

#### 📊 **支持的数据格式**

**格式1（标准格式）：**
```
课程名	教师	学院	校区	学时	学分	时间安排
```

**格式2（新增支持）：**
```
课程名	学分	考试方式	学院	教师	校区	时间安排
```

**示例数据：**
```
新时代中国特色社会主义理论与实践10班	2	考试	马克思主义学院	封莎	清水河	1-5周，星期一第3-4节 (立人楼B417)
7-10周，星期一第3-4节 (立人楼B417)
1-4周，星期四第3-4节 (立人楼B417)
6-10周，星期四第3-4节 (立人楼B417)
学术规范与论文写作1班	1	考查	计算机科学与工程学院	叶茂	清水河	11-14周，星期一第3-4节 星期三第3-4节 (立人楼B417)
```

#### 🔧 **增强特性**
- **多行时间数据**：正确处理跨行的时间安排
- **自动教师匹配**：智能匹配现有教师或自动创建新教师
- **时间段去重**：自动合并重复的时间段
- **周次优化**：智能合并连续或重叠的周次范围
- **详细冲突分析**：提供具体的冲突分析和解决建议

### 2. 按周课表生成

在"生成课表"页面：
- **生成全学期课表**：生成1-20周完整课表
- **生成指定周次课表**：只生成特定周次的课表
- 可设置周次范围（如第1-16周）

### 3. 按周查看课表

在"我的课表"页面：
- 使用周次选择器切换不同周次
- 支持左右箭头快速切换
- 显示当前周次的课程安排
- 课程卡片显示周次信息

## 📋 使用步骤

### 步骤1：添加教师
1. 进入"教师管理"页面
2. 添加课程中涉及的所有教师

### 步骤2：导入课程 ⭐ **流程优化**
1. 进入"课程管理"页面
2. 点击"智能解析导入"按钮
3. 粘贴或输入课程数据（支持两种格式）
4. 点击"解析预览"查看解析结果
5. 在预览表格中检查和编辑课程信息
6. 处理任何冲突或错误提示
7. 点击"确认导入"完成导入

### 步骤3：生成课表
1. 进入"生成课表"页面
2. 选择生成范围：
   - 全学期课表（推荐）
   - 指定周次课表
3. 点击"生成课表"按钮

### 步骤4：查看课表
1. 进入"我的课表"页面
2. 使用周次选择器查看不同周次
3. 可导出当前周次的课表为图片

## 🔧 时间格式解析规则

### 支持的时间格式：

1. **基本格式**
   ```
   1-6周，星期一第5-6节 星期三第5-6节 (立人楼B411)
   ```

2. **多周次格式**
   ```
   1-6周，星期一第5-6节 (教室A)
   7-12周，星期一第5-6节 (教室B)
   ```

3. **连续节次**
   ```
   星期一第1-3节  # 第1、2、3节
   星期二第5节     # 仅第5节
   ```

4. **多个时间段**
   ```
   星期一第1-2节 星期三第5-6节 星期五第9节
   ```

### 解析规则：
- 自动识别星期（支持"星期一"、"周一"等格式）
- 自动解析节次范围（如"第5-6节"解析为第5节和第6节）
- 提取教室信息（括号内的内容）
- 解析周次范围（如"1-6周"）

## 📚 示例数据

项目根目录的 `example_course_data.txt` 文件包含了完整的示例数据，包括：
- 不同周次的课程安排
- 多教师课程
- 复杂时间格式
- 不同教室安排

## ⚠️ 注意事项

1. **数据格式**：确保使用制表符分隔，不要使用空格
2. **教师匹配**：系统现已支持自动创建新教师，无需预先添加
3. **周次冲突**：系统会智能检测真正的时间冲突（考虑周次重叠）
4. **多行数据**：支持跨行的时间安排，系统会自动识别和合并
5. **数据备份**：重要数据请及时导出备份

## 🛠️ 故障排除

### 常见问题及解决方案

1. **"周X 第Y节 有多个课程安排"错误**
   - **原因**：通常是课程时间确实冲突或数据格式问题
   - **解决**：使用"解析预览"功能检查数据，利用"详细冲突分析"和"调试时间段"功能定位问题

2. **教师显示为"未知"**
   - **原因**：教师姓名匹配失败
   - **解决**：系统会自动创建新教师，或在预览中手动编辑教师信息

3. **时间安排显示不正确**
   - **原因**：时间格式解析失败
   - **解决**：检查时间格式是否符合要求，使用"调试时间段"功能查看详细信息

4. **课程重复导入**
   - **原因**：重复的时间段或课程信息
   - **解决**：使用"一键修复重复问题"功能自动处理

## 🛠️ 技术特性

### 核心功能
- **智能解析引擎**：基于正则表达式的强大时间解析，支持复杂时间格式
- **增强冲突检测**：智能检测真正的时间冲突，考虑周次重叠情况 ⭐ **已修复**
- **数据去重算法**：自动合并重复时间段和优化周次范围
- **可视化预览**：导入前完整预览和编辑功能

### 用户体验
- **数据持久化**：使用localStorage自动保存数据
- **响应式设计**：支持移动端和桌面端访问
- **导出功能**：支持课表图片导出和JSON数据导出
- **调试工具**：内置调试功能，帮助定位数据问题

### 最新更新 🆕
- **多格式支持**：支持两种常见的课程数据格式
- **自动教师管理**：智能匹配和创建教师记录
- **错误恢复**：自动修复常见数据问题
- **详细分析**：提供具体的冲突分析和解决建议

## 🚀 未来规划

- [ ] 支持更多时间格式（如单双周）
- [ ] 课程颜色自定义
- [ ] 批量操作功能
- [ ] 更多导出格式（PDF、Excel等）
- [ ] 课程提醒功能
- [ ] 数据导入向导
- [ ] 自定义字段支持

## 🔄 更新日志

### v2.1.0 (最新) - 智能解析重大更新
- ✅ 修复周次冲突检测bug（关键修复）
- ✅ 新增预览和编辑功能
- ✅ 支持多种数据格式
- ✅ 自动教师匹配和创建
- ✅ 时间段去重和优化
- ✅ 详细冲突分析工具
- ✅ 调试功能增强

### v2.0.0 - 按周课表功能
- ✅ 支持20周学期管理
- ✅ 复杂时间格式解析
- ✅ 按周查看和切换
- ✅ 智能课程解析

---

如有问题或建议，请通过项目issue反馈。
